<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout/layout :: head"/>
<body>
<header th:replace="layout/layout :: header"/>
<!-- bradcam_area  -->
<div class="bradcam_area hp_bg_06">
    <div class="container">
        <div class="row">
            <div class="col-xl-12">
                <div class="bradcam_text">
                    <h3>GRAPH ROOM</h3>
                </div>
            </div>
        </div>
    </div>
</div>

<div style="width:80%; height: 100%; border: solid 1px black; margin-left: 10%; margin-top:30px;">
    <canvas id="myChart"></canvas>
</div>


<footer th:replace="layout/layout :: footer"/>
</body>
<script th:replace="layout/layout :: script"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

<script>

    $.ajax({
        method: "post",
        url: "/rest/GraphList"
    })
    .done(function( msg ) {
        //console.log(msg[0].create_date.getMonth());
        var date_arr = [];
        for(var j = 0; j < 12; j++) {
            date_arr[j] = 0;
        }
        for(var i = 0; i < msg.length; i++) {
            var d = new Date(msg[i].create_date);
            if(d.getMonth()+1 == 12) {
                date_arr[11] += 1;
            } else if(d.getMonth()+1 == 11) {
                date_arr[10] += 1;
            } else if(d.getMonth()+1 == 10) {
                date_arr[9] += 1;
            } else if(d.getMonth()+1 == 9) {
                date_arr[8] += 1;
            } else if(d.getMonth()+1 == 8) {
                date_arr[7] += 1;
            } else if(d.getMonth()+1 == 7) {
                date_arr[6] += 1;
            } else if(d.getMonth()+1 == 6) {
                date_arr[5] += 1;
            } else if(d.getMonth()+1 == 5) {
                date_arr[4] += 1;
            } else if(d.getMonth()+1 == 4) {
                date_arr[3] += 1;
            } else if(d.getMonth()+1 == 3) {
                date_arr[2] += 1;
            } else if(d.getMonth()+1 == 2) {
                date_arr[1] += 1;
            } else if(d.getMonth()+1 == 1) {
                date_arr[0] += 1;
            }
        }
        console.log(date_arr + "ㅇㄷ갔누");

        var ctx = document.getElementById('myChart').getContext('2d');
        var chart = new Chart(ctx, {
            // The type of chart we want to create
            type: 'bar',

            // The data for our dataset
            data: {
                labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
                datasets: [{
                    label: '2020년 가입자 통계',
                    backgroundColor: 'rgb(62,147,0)',
                    borderColor: 'rgb(64,64,64)',
                    data: [date_arr[0], date_arr[1], date_arr[2], date_arr[3], date_arr[4], date_arr[5], date_arr[6],
                        date_arr[7], date_arr[8], date_arr[9], date_arr[10], date_arr[11]]
                }]
            },

            // Configuration options go here
            options: {}
        });
        //console.log(d.getMonth() + 1);
        //console.log( "Data Saved : ", msg );
    }).fail(function (error) {
        alert("에러 : " + error);
    });




</script>
</html>