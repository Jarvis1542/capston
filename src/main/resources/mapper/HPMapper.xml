<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fivekm_home.charge.mapper.HPMapper">
    <select id="loadResidence" resultType="com.fivekm_home.charge.domain.HP.HP_loadRes">
        select resName, postcode, roadAddress, jibunAddress, extraAddress, detailAddress, email
        from residence_view
        where email = #{email}
    </select>

    <insert id="hpReg">
        insert into parking_view values(
            #{parkingName},
            #{parkingType},
            #{place},
            #{min30Fee},
            #{addMin10Fee},
            #{manageTime},
            #{parkingPic},
            #{aptMap},
            sysdate,
            'N',
            #{resName}
        )
    </insert>

    <select id="hpRequestList" resultType="com.fivekm_home.charge.domain.HP.HP_requestList">
        select parkingName, parkingType, place, p.resName, r.roadAddress, r.jibunAddress,
               r.detailAddress, p.regDate, m.name, parkingChk
        from parking_view p, residence_view r, member_view m
        where p.resName = r.resName
        and m.email = r.email
    </select>

    <select id="hpRequest" parameterType="com.fivekm_home.charge.domain.HP.HP_request" resultType="com.fivekm_home.charge.domain.HP.HP_request">
        select m.name, parkingName, parkingType, place, min30Fee, addMin10Fee, manageTime,
                r.postcode, r.roadAddress, r.jibunAddress, r.detailAddress, r.extraAddress,
                p.aptMap, p.parkingPic, r.lat, r.lng
        from parking_view p, residence_view r, member_view m
        where p.resName = r.resName
          and m.email = r.email
          and parkingName = #{parkingName}
    </select>

    <select id="hpBook" resultType="com.fivekm_home.charge.domain.HP.HP_book">
        select parkingPic, parkingName, place, min30Fee, addmin10Fee, aptMap,
                roadAddress, extraAddress, name, phone, manageTime, m.email
        from member_view m, parking_view p, residence_view r
        where m.email = r.email
        and p.resName = r.resName
        and parkingName = #{parkingName}
    </select>

    <update id="updateParkingChk">
        update parking_view
        set parkingChk = 'Y'
        where parkingName = #{parkingName}
    </update>
    
    <select id="hpSearchDataList" resultType="com.fivekm_home.charge.domain.HP.HP_search">
        select parkingName, parkingType, min30Fee, addMin10Fee, roadAddress, extraAddress,
        manageTime, place, parkingPic, lat, lng, parkingChk
        from parking_view p, residence_view r
        where p.resName = r.resName
        and parkingChk = 'Y'
    </select>

    <insert id="addBookmark">
        insert into parkingBookmark_view values(
            #{email},
            #{parkingName}
        )
    </insert>

    <delete id="deleteBookmark">
        delete from parkingBookmark_view
        where email = #{email}
        and parkingName = #{parkingName}
    </delete>

    <select id="checkBookmark" resultType="int">
        select count(*)
        from parkingBookmark_view
        where email = #{email}
        and parkingName = #{parkingName}
    </select>
</mapper>